---
title: "FastAPI on Vercel Serverless"
emoji: "ğŸ“˜"
type: "tech"
topics: ["vercel", "fastapi"]
published: true
---

Vercel ã® Serverless Functions ã« Python Runtime(Beta)ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ã€‚
[vercel/example/python](https://github.com/vercel/examples/tree/main/python) ã«ã¯ã€Django ã¨ Flask ã®ã‚µãƒ³ãƒ—ãƒ«ãŒã‚ã‚‹ãŒ FastAPI ãŒç„¡ã‹ã£ãŸã®ã§è©¦ã—ãŸ

### äº‹å‰æº–å‚™

- Vercel ã®[ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ](https://vercel.com/signup)ã—ã€[Vercel CLI](https://vercel.com/docs/cli) ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
- Python 3.9 ç’°å¢ƒã‚’ç”¨æ„ã™ã‚‹
  - Vercel ã® Python Runtime ã¯ã€2023 å¹´ 4 æœˆç¾åœ¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ 3.9 ãŒåˆ©ç”¨ã•ã‚Œã‚‹ãŸã‚
- [Pipenv](https://pipenv-ja.readthedocs.io/ja/translate-ja/#install-pipenv-today) ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹

### FastAPI ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹

äº‹å‰æº–å‚™ãŒæ•´ã£ãŸã‚‰ã€ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã§ Python ç’°å¢ƒã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```sh
$ pipenv â€”-python 3.9
$ pipenv install fastapi
```

Pipfile ã¨ã€Pipfile.lock ãŒä½œæˆã•ã‚ŒãŸã‚‰ OK

### Fast API ã®ã‚½ãƒ¼ã‚¹ã‚’æº–å‚™

FastAPI å…¬å¼ã‚µã‚¤ãƒˆã«ä¾‹ç¤ºã•ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã®ä¸€éƒ¨ã‚’åˆ©ç”¨ã™ã‚‹

- [FastAPI ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://fastapi.tiangolo.com/ja/)

api ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã« server.py ã‚’ä½œæˆ

```sh
$ mkdir api
$ touch api/server.py
$ tree .
.
â”œâ”€â”€ Pipfile
â”œâ”€â”€ Pipfile.lock
â””â”€â”€ api
    â””â”€â”€ server.py
```

api/server.py

```python
from fastapi import FastAPI

app = FastAPI()


@app.get("/")
async def read_root():
    return {"Hello": "World"}
```

### ãƒ‡ãƒ—ãƒ­ã‚¤ã®æº–å‚™

vercel.json ã‚’ä½œæˆ

```sh
$ touch vercel.json
tree .
.
â”œâ”€â”€ Pipfile
â”œâ”€â”€ Pipfile.lock
â”œâ”€â”€ api
â”‚   â””â”€â”€ server.py
â””â”€â”€ vercel.json
```

vercel.json

```json
{
  "rewrites": [{ "source": "/(.*)", "destination": "/api/server" }]
}
```

### ãƒ‡ãƒ—ãƒ­ã‚¤

Vercel CLI ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã ã‘

```sh
$ vercel login
$ vercel .
```

- [Vercel CLI ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://vercel.com/docs/cli)

ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã« curl ã§æ¤œè¨¼

```sh
$ curl -s https://xxxxxxxxxx.vercel.app | jq .
{
  "Hello": "World"
}
```

ã¾ã•ã« API ã® 3 åˆ†ã‚¯ãƒƒã‚­ãƒ³ã‚°ã€‚

### ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ

vercel dev ã—ãŸã‚‰è‰¯ã„

```sh
$ vercel dev
Vercel CLI 28.18.3
> Ready! Available at http://localhost:3000
```

### å‰Šé™¤

ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸ API ãŒä¸è¦ã«ãªã£ãŸã‚‰ã€Vercel ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰å‰Šé™¤ã™ã‚‹ã‹
Vercel CLI ã§å‰Šé™¤ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚

```sh
$ vercel rm my-app
```

### ãã®ä»–

Vercel ã®ã‚µãƒ¼ãƒ“ã‚¹ä»•æ§˜ä¸Šã€åˆ©ç”¨ã™ã‚‹ãƒ—ãƒ©ãƒ³ã«ã‚ˆã£ã¦åˆ¶ç´„ãŒç•°ãªã‚Šã¾ã™ã€‚

- [Vercel Documentation - Limits & Limitations](https://vercel.com/docs/concepts/limits/overview)

### å‚è€ƒæƒ…å ±

- [vercel/examples/python/flask](https://github.com/vercel/examples/tree/main/python/flask)
- [Vercel Documentation - Using the Python Runtime with Serverless Functions](https://vercel.com/docs/concepts/functions/serverless-functions/runtimes/python)
