---
title: "FastAPI ã¨ Litestar ã® Hello World API ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯"
emoji: "ğŸ•"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["fastapi", "litestar"]
published: true
---

Litestar ã¨ã„ã† Python ã® ASGI ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒã€FastAPI ã‚„ Starlette ã¨åŒç­‰
ã‚‚ã—ãã¯ã€ãã‚Œä»¥ä¸Šã«é«˜é€Ÿã‚‰ã—ã„ã£ã¦ã“ã¨ã§æ°—ã«ãªã£ã¦è»½ãèª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚

[![Litestar](https://litestar.dev/_static/logo.svg)](https://github.com/litestar-org/litestar)

### å‰ææ¡ä»¶

- MacBook Air M2 2022(MEM 16GB)
- macOS 13.4
- Python 3.9.14
- uvicorn ã§èµ·å‹•ã•ã‚ŒãŸãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‚’å¯¾è±¡ã«ã€h2load ã§ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’å®Ÿè¡Œ
- å¯¾è±¡ã® API ã¯ã€Hello World

ã„ãšã‚Œã‚‚å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ä¾‹ç¤ºã•ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’åˆ©ç”¨

### FastAPI ã®ã‚µãƒ³ãƒ—ãƒ«

```python:server.py
from fastapi import FastAPI

app = FastAPI()


@app.get("/")
async def read_root():
    return {"Hello": "World"}
```

FastAPI å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ä¾‹ç¤ºã•ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã®ä¸€éƒ¨ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚

- [FastAPI ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://fastapi.tiangolo.com/ja/)

### Litestar ã®ã‚µãƒ³ãƒ—ãƒ«

```python:server.py
from starlite import Starlite, get


@get("/")
def hello_world() -> dict[str, str]:
    return {"hello": "world"}


app = Starlite(route_handlers=[hello_world])
```

Litestar å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ä¾‹ç¤ºã•ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã®ä¸€éƒ¨ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚

- [The Starlite App](https://docs.litestar.dev/latest/usage/the-starlite-app.html)

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã™ã‚‹

Starlite ã‚’ 8000 ç•ªãƒãƒ¼ãƒˆã§ã€FastAPI ã‚’ 8001 ç•ªãƒãƒ¼ãƒˆã§èµ·å‹•ã—ã¾ã™ã€‚

```sh
$ uvicorn server:app --reload --port 8000
$ uvicorn server:app --reload --port 8001
```

### ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯

ä»Šå›ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã§ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆç·æ•° 100,000 ã‚’ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆä¸¦åˆ—åŒ–ãªã—ï¼‰ã«å‡¦ç†ã™ã‚‹ã‚·ãƒŠãƒªã‚ªã¨ã€100 ä¸¦åˆ—ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæ•° 100ï¼‰ã«å‡¦ç†ã™ã‚‹ã‚·ãƒŠãƒªã‚ªã§æ¤œè¨¼ã—ã¾ã™ã€‚h2load ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€ä¸‹è¨˜ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§

- [h2load - HTTP/2 benchmarking tool - HOW-TO](https://nghttp2.org/documentation/h2load-howto.html)

ã¾ãšã¯ã€FastAPI ã‹ã‚‰

#### FastAPI ï¼ˆä¸¦åˆ—åŒ–ãªã—ï¼‰ ãƒªã‚¯ã‚¨ã‚¹ãƒˆç·æ•° 100,000

```sh
$ for x in (seq 10)
    h2load --h1 -n100000 http://localhost:8001 | grep 'finished in'
end
finished in 51.29s, 1949.89 req/s, 270.39KB/s
finished in 50.87s, 1965.81 req/s, 272.60KB/s
finished in 49.53s, 2019.08 req/s, 279.99KB/s
finished in 49.66s, 2013.79 req/s, 279.26KB/s
finished in 49.74s, 2010.52 req/s, 278.80KB/s
finished in 48.88s, 2045.64 req/s, 283.67KB/s
finished in 49.57s, 2017.28 req/s, 279.74KB/s
finished in 51.81s, 1930.04 req/s, 267.64KB/s
finished in 49.84s, 2006.42 req/s, 278.23KB/s
finished in 49.01s, 2040.26 req/s, 282.93KB/s
```

10 å›å¹³å‡ã®å‡¦ç†æ™‚é–“ 50.02 ç§’
ç§’é–“ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•° 1999.873

#### FastAPI ï¼ˆ100 ä¸¦åˆ—ï¼‰ ãƒªã‚¯ã‚¨ã‚¹ãƒˆç·æ•° 100,000

```sh
$ for x in (seq 10)
    h2load --h1 -n100000 -c100 http://localhost:8001 | grep 'finished in'
end
finished in 28.63s, 3492.41 req/s, 484.30KB/s
finished in 32.19s, 3106.40 req/s, 430.77KB/s
finished in 33.16s, 3016.07 req/s, 418.24KB/s
finished in 32.97s, 3033.42 req/s, 420.65KB/s
finished in 32.32s, 3093.60 req/s, 429.00KB/s
finished in 32.75s, 3053.14 req/s, 423.38KB/s
finished in 34.06s, 2936.42 req/s, 407.20KB/s
finished in 33.91s, 2948.60 req/s, 408.89KB/s
finished in 31.55s, 3169.29 req/s, 439.49KB/s
finished in 32.13s, 3112.64 req/s, 431.63KB/s
```

10 å›å¹³å‡ã®å‡¦ç†æ™‚é–“ 32.367 ç§’
ç§’é–“ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•° 3096.199

æ¬¡ã« Starlite

#### Starlite ï¼ˆä¸¦åˆ—åŒ–ãªã—ï¼‰ ãƒªã‚¯ã‚¨ã‚¹ãƒˆç·æ•° 100,000

```sh
$ for x in (seq 10)
    h2load --h1 -n100000 http://localhost:8000 | grep 'finished in'
end
finished in 31.89s, 3136.09 req/s, 434.89KB/s
finished in 30.63s, 3264.70 req/s, 452.72KB/s
finished in 30.77s, 3250.44 req/s, 450.74KB/s
finished in 30.45s, 3284.52 req/s, 455.47KB/s
finished in 30.45s, 3284.56 req/s, 455.48KB/s
finished in 30.06s, 3326.51 req/s, 461.29KB/s
finished in 30.20s, 3310.92 req/s, 459.13KB/s
finished in 29.93s, 3341.63 req/s, 463.39KB/s
finished in 30.81s, 3245.74 req/s, 450.09KB/s
finished in 30.63s, 3264.30 req/s, 452.67KB/s
```

10 å›å¹³å‡ã®å‡¦ç†æ™‚é–“ 30.582 ç§’
ç§’é–“ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•° 3270.941

#### Starlite ï¼ˆ100 ä¸¦åˆ—ï¼‰ ãƒªã‚¯ã‚¨ã‚¹ãƒˆç·æ•° 100,000

```sh
$ for x in (seq 10)
    h2load --h1 -n100000 -c100 http://localhost:8000 | grep 'finished in'
end
finished in 24.29s, 4117.16 req/s, 570.93KB/s
finished in 22.86s, 4373.53 req/s, 606.49KB/s
finished in 22.50s, 4445.17 req/s, 616.42KB/s
finished in 22.35s, 4474.03 req/s, 620.42KB/s
finished in 22.42s, 4460.72 req/s, 618.58KB/s
finished in 23.17s, 4316.67 req/s, 598.60KB/s
finished in 23.02s, 4343.54 req/s, 602.33KB/s
finished in 23.41s, 4271.08 req/s, 592.28KB/s
finished in 25.10s, 3984.42 req/s, 552.53KB/s
finished in 25.97s, 3850.01 req/s, 533.89KB/s
```

10 å›å¹³å‡ã®å‡¦ç†æ™‚é–“ 23.509 ç§’
ç§’é–“ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•° 4263.633

### çµæœ

ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ï¼šå˜ç´”æ¯”è¼ƒã§ 60%ç¨‹åº¦ Starlite ãŒé«˜é€Ÿ
100 ä¸¦åˆ—ï¼šå˜ç´”æ¯”è¼ƒã§ 30%ç¨‹åº¦ Starlite ãŒé«˜é€Ÿ

æ€§èƒ½é¢ã«é–¢ã—ã¦ã¯ç·ã˜ã¦ã€Starlite å„ªå‹¢ã§ã—ãŸã€‚ä»–ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨æ¯”è¼ƒã—ã¦ã‚‚ã€ã„ã‚ã„ã‚ãªæ©Ÿèƒ½ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã¿ãŸã„ãªã®ã§ã‚‚ã†å°‘ã—ã€Litestar ã‚’è©¦ã—ã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚

- [Feature comparison with similar frameworks](https://docs.litestar.dev/2/#feature-comparison-with-similar-frameworks)

ãªãŠã€å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¯ã€ã‚ˆã‚Šè©³ç´°ãªã‚·ãƒŠãƒªã‚ªåˆ¥ã®æ¯”è¼ƒãƒ‡ãƒ¼ã‚¿ãŒå…¬é–‹ã•ã‚Œã¦ãŠã‚Š
ASGI API ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆç”¨ã«å°‚ç”¨ã®ãƒªãƒã‚¸ãƒˆãƒªã‚‚ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚
èˆˆå‘³ãŒã‚ã‚Œã°ã©ã†ãã€‚

- [Benchmarks](https://docs.litestar.dev/2/benchmarks.html)
- [Benchmarks of ASGI API Frameworks](https://github.com/litestar-org/api-performance-tests)
