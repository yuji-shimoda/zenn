---
title: "FastAPI Routing on Vercel Serverless"
emoji: "ğŸ›£ï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["vercel", "fastapi"]
published: true
---

[å‰å›ã®è¨˜äº‹](https://zenn.dev/yuji_shimoda/articles/49d2a39f2dca83)ã§ã€Vercel ã« FastAPI ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã—ãŸã€‚

ã™ã¹ã¦ã®æ©Ÿèƒ½ãŒå˜ä¸€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã¨ã€æ©Ÿèƒ½è¿½åŠ ã«ä¼´ã£ã¦ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®è¦‹é€šã—ãŒæ‚ªåŒ–ã—ã¾ã™ã€‚ãã“ã§ã€FastAPI ã® APIRouter ã‚’æ´»ç”¨ã—ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ã‚’ç¢ºä¿ã—ã¾ã™ã€‚

- [FastAPI - APIRouter](https://fastapi.tiangolo.com/tutorial/bigger-applications/#apirouter)

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

:::message
æœ¬è¨˜äº‹ã§ã¯ã€Hello APIï¼ˆGET /helloï¼‰ã‚’å®Ÿè£…ã—ã¾ã™
:::

```sh
$ mkdir api/hello
$ touch api/hello/views.py
$ tree api/
api/
â”œâ”€â”€ hello
â”‚   â””â”€â”€ views.py
â””â”€â”€ server.py
```

API ãƒ‘ã‚¹ã¨åŒåã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã€api ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«è¿½åŠ ã—ã¦æ©Ÿèƒ½ã‚’é›†ç´„ã—ã¾ã™ã€‚

### ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰

```python:views.py
from fastapi import APIRouter

router = APIRouter()


@router.get("")
async def read_hello():
    return {"msg": "Hello World"}
```

api/hello/views.py ã§ã¯ã€/hello api ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

```python:server.py
from fastapi import FastAPI, APIRouter
from api.hello.views import router as hello_router

app = FastAPI()
app.include_router(hello_router, prefix="/hello", tags=["Hello"])
```

views.py ã§å®šç¾©ã•ã‚ŒãŸ router ã‚’ app ã« include ã™ã‚‹éš›ã« `prefix="/hello"` ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€views.py ã® ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ‘ã‚¹ã«ã¯å…¨ã¦ `/hello` prefix ãŒè‡ªå‹•çš„ã«ä»˜ä¸ã•ã‚Œã¾ã™ã€‚

### å‹•ä½œç¢ºèª

vercel dev ã§ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‚’èµ·å‹•ã—ã¦ã€curl ã§å‹•ä½œã‚’ç¢ºèªã—ã¦ã¿ã¾ã™ã€‚

```sh
$ vercel dev
Vercel CLI 28.18.3
> Ready! Available at http://localhost:3000
```

```sh
$ curl -s http://localhost:3000/hello | jq .
{
  "msg": "Hello World"
}
```

è‰¯ã•ãã†ã§ã™
